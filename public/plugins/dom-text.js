var r,s,t,v,w,x;s=RegExp("[ \t\r\n\u00a0]");$.textNode=$.a=function(a){return document.createTextNode(a)};r=function(a,b){var c;c=function(a){var d,f,g;if(3===a.nodeType){if((f=a.nodeValue.length)>=b)return{container:a,offset:b};b-=f}else for(g=a.childNodes,a=0,f=g.length;a<f;a++)if(d=g[a],d=c(d))return d};return c(a)};x=function(a,b,c,e){var d,f,g,l;if(3===a.nodeType){if(l=e(a))return l}else for(d=a.childNodes,f=0,g=a===b?c:d.length;f<g;){if(l=x(d[f],b,c,e))return l;++f}return a===b};
t=function(){var a,b;a=!1;b=function(c,e,d,f){var g,l,h;if(3===c.nodeType){if(a||(a=c===e.container))if(h=f(c))return h}else{g=c.childNodes;var k=c===e.container?(a=!0,e.offset):0;for(l=c===d.container?d.offset:g.length;k<l;){if(h=b(g[k],e,d,f))return h;++k}}return c===d.container};return function(c,e,d,f){a=!1;return b(c,e,d,f)}}();
w=function(){var a,b;a=!1;b=function(c,e,d,f){var g,l,h,k;if(3===c.nodeType){if(a||(a=c===e.container))if(k=f(c))return k}else{g=c.childNodes;var m=c===e.container?(a=!0,e.offset):0;for(l=g.length;m<l;){h=g[m];if(a&&(k=d(h,c,m))||(k=b(g[m],e,d,f)))return k;++m}}};return function(c,e,d,f){a=!1;return b(c,e,d,f)}}();
v=function(){var a,b;a=!1;b=function(c,e,d,f){var g,l,h;if(3===c.nodeType){if(a||(a=c===e.container))if(h=f(c))return h}else{g=c.childNodes;for(var k=-1+(c===e.container?(a=!0,e.offset):g.length);0<=k;){l=g[k];if(a&&(h=d(l,c,k))||(h=b(g[k],e,d,f)))return h;--k}}};return function(c,e,d,f){a=!1;return b(c,e,d,f)}}();
$.addText=function(a,b,c){var e,d;if($.isText(a.container))if(a.offset>=a.container.nodeValue.length){if(a.container.nodeValue+=b,c)return{start:{container:a.container,offset:a.container.nodeValue.length-b.length},end:{container:a.container,offset:a.container.nodeValue.length}}}else{if(d=a.offset?a.container.splitText(a.offset):a.container,d.nodeValue=b+d.nodeValue,c)return{start:{container:d,offset:0},end:{container:d,offset:b.length}}}else if(e=a.container.childNodes,d=document.createTextNode(b),
a.offset===e.length?a.container.appendChild(d):a.container.insertBefore(d,e[a.offset]),c)return{start:{container:d,offset:0},end:{container:d,offset:b.length}}};
$.fn.extend({contains:function(a){var b;if(b=a.container)a=b;if(a===(b=this[0]))return!0;for(;a=a.parentNode;)if(b===a)return!0;return!1},textOffsetToPos:function(a){var b,c;b=this[0];return null!=(c=r(b,a))?c:{container:b,offset:(3===b.nodeType?b.nodeValue:b.childNodes).length}},keepSelection:function(){var a,b,c,e,d,f,g,l,h;d=e=l=a=h=b=c=0;g=function(d){var e,f,n,q;q=d===l.container;n=d===a.container;if(3===d.nodeType){q&&(h=c+l.offset);if(n)return b=c+a.offset,!0;c+=d.nodeValue.length}else for(e=
0,f=(d=d.childNodes).length;;){q&&e===l.offset&&(h=c);if(n&&e===a.offset)return b=c,!0;if(e===f)break;if(g(d[e]))return!0;++e}};f=function(g){var m,p,n,q,u;u=g===l.container;q=g===a.container;if(3===g.nodeType){m=c+g.nodeValue.length;c<=h&&h<=m&&(u||!d)&&(d||(d={}),d.container=g,d.offset=h-c);c<=b&&b<=m&&(q||!e)&&(e||(e={}),e.container=g,e.offset=b-c);if(m>b&&m>h)return!0;c=m}else for(p=0,n=(m=g.childNodes).length;;){if(u&&c===h&&(d||(d={}),d.container=g,d.offset=p,!~b))return!0;if(q&&c===b)return e||
(e={}),e.container=g,e.offset=p,!0;if(p===n)break;if(f(m[p]))return!0;++p}};return function(k,m){var p,n;null==m&&(m=k,k=$.selection());if(!k)return m();n=this[0];l=k.start;a=k.end;h=b=-1;c=0;g(n);p=m();c=0;d=e=void 0;if(~h||~b)f(n),d&&e||(n={container:n,offset:n.childNodes.length},~h&&(d=n),~b&&(e=n)),d||(d=$.selection().start),e||(e=$.selection().end),$.selection(d,e);return p}}(),prevTextUntil:function(a,b){var c;c="";v(this[0],a,b,function(b){c=""+(b===a.container?(""+b.nodeValue).substring(0,
a.offset):b.nodeValue)+c});return c},nextTextUntil:function(a,b){var c;c="";w(this[0],a,b,function(b){c+=b===a.container?(""+b.nodeValue).substring(a.offset):b.nodeValue});return c},isLastChar:function(a){var b,c,e;b=a.container;a=a.offset;e=this[0];if(3===b.nodeType){if(b.nodeValue.length>a)return!1;if(b===e)return!0}else if(a&&(c=b,!(b=c.childNodes[a-1]))){if(c===e)return!1;b=c}for(;;){for(c=b.parentNode;b=b.nextSibling;)if(b.nodeValue||b.textContent||b.innerText)return!1;if(e===c)return!0;b=c}},
wordEndUntil:function(a,b){var c,e,d;d=this[0];c=void 0;return(e=w(d,a,function(a,c,d){if(b(a))return{container:c,offset:d}},function(b){var d;c=b;if(~(d=(b===a.container?(""+b.nodeValue).substr(a.offset):""+b.nodeValue).search(s)))return{container:b,offset:d+(b===a.container?a.offset:0)}}))?e:c?{container:c,offset:c.nodeValue.length}:{container:d,offset:d.childNodes.length}},textInRange:function(a,b){var c,e;a.start&&(b=a.end,a=a.start);if(document.createRange)return c=global.document.createRange(),
c.setStart(a.container,a.offset),c.setEnd(b.container,b.offset),c.toString();e="";t(this[0],a,b,function(c){a=c===a.container?a.offset:0;c===b.container&&(b=b.offset);e+=(""+c.nodeValue).substring(a,b)});return e},textOffset:function(a,b){var c,e,d,f;c=0;f=this[0];b?t(f,a,b,function(d){c+=(d===b.container?b.offset:d.nodeValue.length)-(d===a.container?a.offset:0)}):("number"===typeof a?(e=f,d=a):(e=a.container,d=a.offset),x(f,e,d,function(a){a===e?c+=d:a.nodeValue&&(c+=a.nodeValue.length)}));return c},
prevText:function(){var a,b;a=this[0];for(b="";(a=a.previousSibling)&&3===a.nodeType;)b=""+a.nodeValue+b;return b},prevTextNode:function(a){var b,c,e,d;b=this[0];if((c=b.previousSibling)&&3===c.nodeType){for(b=(d=c).previousSibling;b&&3===b.nodeType;)null==a&&(e=""+b.nodeValue+e),c=b.previousSibling,b.parentNode.removeChild(b),b=c;null!=a?d.nodeValue=a:e&&(d.nodeValue=""+e+d.nodeValue)}else d=document.createTextNode(a||""),b.parentNode.insertBefore(d,b);return d},nextText:function(){var a,b;a=this[0];
for(b="";(a=a.nextSibling)&&3===a.nodeType;)b+=a.nodeValue;return b},nextTextNode:function(a){var b,c,e,d;c=this[0];e="";if((b=c.nextSibling)&&3===b.nodeType){for(c=(d=b).nextSibling;c&&3===c.nodeType;)null==a&&(e+=c.nodeValue),b=c.nextSibling,c.parentNode.removeChild(c),c=b;null!=a?d.nodeValue=a:e&&(d.nodeValue=""+d.nodeValue+e)}else d=document.createTextNode(a||""),b?c.parentNode.insertBefore(d,b):c.parentNode.appendChild(d);return d}});